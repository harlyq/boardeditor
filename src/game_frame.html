<!DOCTYPE html>
<html>

<head>
    <script src="game.js" type="text/javascript"></script>

    <script>
    var myKey = Math.random().toString();
    var gameKey = '1';

    window.addEventListener('message', function(e) {
        alert(e);
    })

    window.addEventListener('load', function() {
        var req = new XMLHttpRequest();
        req.onload = function() {
            var msg = JSON.parse(this.response);
            if ('type' in msg && msg.type === 'config') {
                // forward the message to the iframe
                var iframe = document.getElementById("main");
                iframe.contentWindow.postMessage(JSON.stringify(msg), '*');
            }
        };
        req.open('POST', 'adduser?gameKey=' + gameKey + '&key=' + myKey + '&type=human');
        req.setRequestHeader('Content-Type', 'application/json');
        req.send();
    });
    </script>
</head>

<body>
    <div>This is the game frame</div>
    <iframe id="main" src="loveletter_common.html" frameborder="0" scrolling="no" width="850px" height="1800px"></iframe>
</body>

</html>
