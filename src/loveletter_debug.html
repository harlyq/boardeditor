<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=600">
    <script src="seedrandom.js" type="text/javascript"></script>
    <script src="boardsystem.js" type="text/javascript"></script>
    <script src="pluginhelper.js" type="text/javascript"></script>
    <script src="coreplugins.js" type="text/javascript"></script>
    <script src="loveletter_setup.js" type="text/javascript"></script>
    <script src="loveletter_rules.js" type="text/javascript"></script>

    <script>
    // will fail if generators not supported
    function* areGeneratorsSupported() {
        yield "isYieldSupported";
    }

    window.addEventListener('load', function(e) {
        var myGame = require("./loveletter_rules"); // for whereList and setup

        var config = {
            type: 'config',
            screens: [{
                screen: 'bank',
                transport: 'local',
                user: 'BANK',
                type: 'bank'
            }, {
                screen: 'common1',
                transport: 'message',
                iframe: 'iframe1',
                user: 'PLAYER1',
                type: 'human'
            }, {
                screen: 'common2',
                transport: 'message',
                iframe: 'iframe2',
                user: 'PLAYER2',
                type: 'human'
            }, {
                screen: 'common3',
                transport: 'message',
                iframe: 'iframe3',
                user: 'PLAYER3',
                type: 'human'
            }, {
                screen: 'common4',
                transport: 'message',
                iframe: 'iframe4',
                user: 'PLAYER4',
                type: 'human'
            }]
        };

        var config2 = {
            type: 'config',
            screens: [{
                screen: 'bank',
                transport: 'local',
                user: 'BANK',
                type: 'bank'
            }, {
                screen: 'common1',
                transport: 'message',
                iframe: 'iframe1',
                user: 'PLAYER1,PLAYER2,PLAYER3,PLAYER4',
                type: 'human'
            }]
        }

        var server = BoardSystem.createServer(myGame, config);
        //var server = BoardSystem.createServer(myGame, config2);

        // use a short pause before starting a new game, to ensure that the server config
        // message is received before any new game information
        // setTimeout(function() {
        //     server.newGameGen = myGame.newGameGen;
        //     server.rulesGen = myGame.rulesGen;
        //     server.newGame()
        // }, 100);
        document.getElementById("start").addEventListener("click", function() {
            server.newGameGen = myGame.newGameGen;
            server.rulesGen = myGame.rulesGen;
            server.newGame();
        });
    });
    </script>

    <style>
    iframe {
        overflow: hidden;
    }
    </style>
</head>

<body>
    <button id="start">start</button>
    <iframe id="iframe1" src="loveletter_common.html" width="800" height="750" scrolling="no">
        Missing loveletter_common.html
    </iframe>
    <iframe id="iframe2" src="loveletter_common.html" width="800" height="750" scrolling="no">
        Missing loveletter_common.html
    </iframe>
    <iframe id="iframe3" src="loveletter_common.html" width="800" height="750" scrolling="no">
        Missing loveletter_common.html
    </iframe>
    <iframe id="iframe4" src="loveletter_common.html" width="800" height="750" scrolling="no">
        Missing loveletter_common.html
    </iframe>
</body>

</html>
